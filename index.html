<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kumpulan Website Induk - Tema MLBB</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Import Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Import PDF and Canvas rendering libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        /* --- Font Imports --- */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&family=Share+Tech+Mono&display=swap');
        /* [NEW] Import heroic font for MLBB theme */
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&display=swap');

        /* --- Variabel Warna & Tema MLBB --- */
        :root {
            /* Updated color palette for the MLBB theme */
            --neon-blue: #68c5ff;  /* MLBB Blue */
            --neon-pink: #ffd700;  /* MLBB Gold */
            --neon-purple: #8765f7; /* MLBB Magic Purple */
            --dark-bg: #0b153d;   /* MLBB Deep Blue */
            --darker-bg: #0e214a;  /* MLBB Darker Shade */
            --nav-dark: #0b153d;   /* Navigation background */
            /* --- Variabel Warna Terminal (File 2) --- */
            --terminal-bg: #0a0a12;
            --terminal-green: #0f0;
            --terminal-cyan: #0ff;
            --terminal-purple-term: #b19cd9; /* Renamed to avoid conflict */
            --terminal-red: #f44;
            --terminal-glow: rgba(0, 255, 0, 0.7);
            --text-color: #e0e0e0;
            /* [PERBAIKAN] Mengganti shadow default di terminal dari hijau ke putih lembut agar lebih mudah dibaca */
            --text-shadow: 0 0 5px rgba(224, 224, 224, 0.5);
        }
 
        /* --- Styling Dasar (File 1) --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--dark-bg);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            z-index: 0;
        }

        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
        }
        
        #bg-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            /* Overlay cosmic gradient to create MLBB ambience */
            background-image: radial-gradient(circle at 20% 30%, rgba(104,197,255,0.25), transparent 70%), radial-gradient(circle at 80% 70%, rgba(255,215,0,0.2), transparent 70%), var(--bg-image, none);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: -2;
        }
 
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* Soft grid overlay in MLBB blue for subtle structure */
            background-image: linear-gradient(to right, rgba(104, 197, 255, 0.05) 1px, transparent 1px),
                              linear-gradient(to bottom, rgba(104, 197, 255, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out;
        }
 
        /* --- [PERBAIKAN] Text Stroke dibuat lebih spesifik --- */
        /* Menghapus stroke global agar tidak bentrok dengan card */
        body.has-bg-media header,
        body.has-bg-media .holographic-effect,
        body.has-bg-media footer {
             text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        }
        body.has-bg-media .neon-text-blue,
        body.has-bg-media .neon-text-pink,
        body.has-bg-media .neon-text-purple {
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 0 0 8px currentColor;
        }

        /* --- Font Spesifik (File 1) --- */
        h1, h2, h3, .nav-item, .portal-card h3, #time, #date {
            font-family: 'Cinzel', 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }

        .font-tech {
            font-family: 'Roboto Mono', monospace;
        }

        /* --- Efek Glitch & Neon (File 1) --- */
        .glitch-effect {
            position: relative;
            color: white;
        }

        .glitch-effect::before, .glitch-effect::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.8;
        }

        .glitch-effect::before {
            color: var(--neon-blue);
            z-index: -1;
            animation: glitch-effect 3s infinite;
        }

        .glitch-effect::after {
            color: var(--neon-pink);
            z-index: -2;
            animation: glitch-effect 2s infinite reverse;
        }

        @keyframes glitch-effect {
            0% { transform: translate(0); }
            20% { transform: translate(-3px, 3px); }
            40% { transform: translate(-3px, -3px); }
            60% { transform: translate(3px, 3px); }
            80% { transform: translate(3px, -3px); }
            100% { transform: translate(0); }
        }

        .neon-text-blue {
            color: var(--neon-blue);
            text-shadow: 0 0 5px var(--neon-blue), 0 0 10px var(--neon-blue), 0 0 15px var(--neon-blue);
        }

        .neon-text-pink {
            color: var(--neon-pink);
            text-shadow: 0 0 5px var(--neon-pink), 0 0 10px var(--neon-pink), 0 0 15px var(--neon-pink);
        }

        .neon-text-purple {
            color: var(--neon-purple);
            text-shadow: 0 0 5px var(--neon-purple), 0 0 10px var(--neon-purple), 0 0 15px var(--neon-purple);
        }

        .neon-border-blue {
            border: 1px solid var(--neon-blue);
            box-shadow: 0 0 5px var(--neon-blue), inset 0 0 5px var(--neon-blue), 0 0 15px var(--neon-blue);
        }

        .neon-border-pink {
            border: 1px solid var(--neon-pink);
            box-shadow: 0 0 5px var(--neon-pink), inset 0 0 5px var(--neon-pink), 0 0 15px var(--neon-pink);
        }

        .neon-underline {
            position: relative;
            display: inline-block;
        }

        .neon-underline::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, var(--neon-blue), var(--neon-pink));
            transform: scaleX(0);
            transform-origin: bottom right;
            transition: transform 0.5s ease-out;
        }

        .neon-underline:hover::after {
            transform: scaleX(1);
            transform-origin: bottom left;
        }

        /* --- Komponen UI (File 1) --- */
        .dropdown {
            display: none;
            background: var(--nav-dark);
            border: 1px solid var(--neon-blue);
            box-shadow: 0 0 20px var(--neon-blue);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .group:hover .dropdown {
            display: block;
        }

        .nav-item:hover {
            transform: translateY(-2px);
            transition: transform 0.3s ease;
        }

        .portal-card {
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            perspective: 1000px;
            transform-style: preserve-3d;
        }

        .portal-card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 0 20px currentColor;
        }

        .portal-card-inner {
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .portal-card:hover .portal-card-inner {
            transform: rotateY(15deg) rotateX(10deg);
        }

        .profile {
            margin: 0 auto 1.5rem;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            overflow: hidden;
            border: 4px solid var(--neon-pink);
            box-shadow: 0 0 20px var(--neon-pink), 0 0 30px var(--neon-purple);
            transition: transform 0.3s ease;
        }
        .profile:hover {
            transform: scale(1.05);
        }
        .profile img { width: 100%; height: 100%; object-fit: cover; }

        .modal-overlay {
            background: rgba(5, 1, 14, 0.9);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            animation: slideIn 0.3s ease;
            background: var(--darker-bg);
            max-height: 90vh;
            overflow-y: auto;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-block;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.selected::after {
            content: "✓";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
        }

        .custom-color-input {
            width: 100%;
            height: 30px;
            border: none;
            background: transparent;
            cursor: pointer;
            margin-top: 10px;
        }

        .bg-preview, .icon-preview {
            max-width: 100%;
            height: auto;
            margin-top: 10px;
            border-radius: 5px;
            display: none;
        }

        .holographic-effect {
            position: relative;
            overflow: hidden;
        }

        .holographic-effect::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                rgba(255, 255, 255, 0) 45%,
                rgba(104, 197, 255, 0.2) 50%,
                rgba(255, 255, 255, 0) 55%
            );
            transform: rotate(30deg);
            animation: holographic 6s linear infinite;
        }

        @keyframes holographic {
            0% { transform: translateY(-100%) rotate(30deg); }
            100% { transform: translateY(100%) rotate(30deg); }
        }

        footer {
            text-align: center;
            padding: 2rem 0;
            font-size: 0.9rem;
            opacity: 0.8;
            position: relative;
            z-index: 1;
        }

        #mobile-menu {
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
        }
        
        #volume-control {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            z-index: 100;
            width: 40px;
            height: 40px;
            background: rgba(13, 2, 33, 0.7);
            border: 1px solid var(--neon-blue);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        #volume-control:hover {
            background: var(--neon-blue);
            color: var(--darker-bg);
        }

        /* --- [MODIFIED] Preview Mode --- */
        /* Add smooth transitions to the elements that will be hidden */
        main, footer, #volume-control, #futuristic-watermark {
            transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
        }

        .navbar {
             transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out, background-color 0.5s ease-in-out;
        }

        /* Animate elements out instead of just hiding them */
        body.preview-mode-active .navbar {
            opacity: 0;
            transform: translateY(-100%);
            pointer-events: none;
        }
        
        body.preview-mode-active main,
        body.preview-mode-active footer,
        body.preview-mode-active #volume-control,
        body.preview-mode-active #futuristic-watermark {
            opacity: 0;
            transform: translateY(30px);
            pointer-events: none;
        }
        
        /* [NEW] Make only the logo visible in preview mode */
        body.preview-mode-active .navbar #logo-container {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        
        body.preview-mode-active .navbar {
            background-color: transparent !important;
            backdrop-filter: none !important;
            border-bottom-color: transparent !important;
        }

        /* [NEW] Hide the grid lines in preview mode */
        body.preview-mode-active::after {
            opacity: 0;
        }

        /* --- STYLING DARI CYBER TERMINAL (File 1) --- */
        .terminal-container {
            width: 100%;
            max-width: 800px;
            height: 40vh;
            background: var(--terminal-bg);
            border-radius: 8px;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.5),
                        inset 0 0 10px rgba(0, 255, 0, 0.2);
            overflow: hidden;
            border: 1px solid var(--terminal-green);
            margin: 0 auto 3rem;
            transition: background 0.5s ease;
        }
        
        .terminal-container.is-transparent {
            background: rgba(10, 10, 18, 0.7);
            backdrop-filter: blur(5px);
        }

        .terminal-header {
            background: linear-gradient(to right, #0a0a0a, #111);
            padding: 8px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--terminal-green);
            font-family: 'Share Tech Mono', monospace;
            border-bottom: 1px solid var(--terminal-green);
            box-shadow: 0 2px 15px rgba(0, 255, 0, 0.3);
        }

        .terminal-buttons {
            display: flex;
            gap: 8px;
        }

        .terminal-button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .terminal-button.red { background: #ff5f56; }
        .terminal-button.yellow { background: #ffbd2e; }
        .terminal-button.green { background: #27c93f; }

        .terminal-body {
            padding: 15px;
            height: calc(100% - 40px);
            overflow-y: auto;
            color: var(--text-color);
            text-shadow: var(--text-shadow);
            line-height: 1.6;
            font-family: 'Inconsolata', monospace;
        }

        .typing-text {
            white-space: pre-wrap;
            font-size: 1.1rem;
        }

        .command-line {
            margin-top: 20px;
            display: flex;
            align-items: center;
        }

        .prompt {
            color: var(--terminal-green);
            margin-right: 10px;
            font-weight: bold;
        }

        .cursor {
            display: inline-block;
            width: 10px;
            height: 20px;
            background: var(--terminal-green);
            animation: blink 1s infinite;
            vertical-align: middle;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .command-input {
            flex-grow: 1;
            background: transparent;
            border: none;
            color: var(--terminal-green);
            font-family: 'Inconsolata', monospace;
            font-size: 1.1rem;
            outline: none;
            caret-color: var(--terminal-green);
            text-shadow: var(--text-shadow);
        }

        .glitch {
            position: relative;
        }

        .glitch::before, .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--terminal-bg);
        }
        
        .terminal-container.is-transparent .glitch::before,
        .terminal-container.is-transparent .glitch::after {
            background: transparent;
        }


        .glitch::before {
            left: 2px;
            text-shadow: -2px 0 var(--terminal-red);
            clip: rect(24px, 550px, 90px, 0);
            animation: glitch-anim-1 2s infinite linear alternate-reverse;
        }

        .glitch::after {
            left: -2px;
            text-shadow: -2px 0 var(--terminal-cyan);
            clip: rect(85px, 550px, 140px, 0);
            animation: glitch-anim-2 2s infinite linear alternate-reverse;
        }

        @keyframes glitch-anim-1 {
            0% { clip: rect(54px, 800px, 54px, 0); }
            20% { clip: rect(27px, 800px, 86px, 0); }
            40% { clip: rect(14px, 800px, 75px, 0); }
            60% { clip: rect(39px, 800px, 104px, 0); }
            80% { clip: rect(18px, 800px, 53px, 0); }
            100% { clip: rect(73px, 800px, 112px, 0); }
        }

        @keyframes glitch-anim-2 {
            0% { clip: rect(35px, 800px, 89px, 0); }
            20% { clip: rect(56px, 800px, 103px, 0); }
            40% { clip: rect(22px, 800px, 64px, 0); }
            60% { clip: rect(88px, 800px, 120px, 0); }
            80% { clip: rect(13px, 800px, 32px, 0); }
            100% { clip: rect(42px, 800px, 99px, 0); }
        }

        .highlight { color: var(--terminal-cyan); }
        .hidden { display: none; }
        
        /* --- [NEW] Text Stroke for Readability on Background Image --- */
        .terminal-container.is-transparent .terminal-body span,
        .terminal-container.is-transparent .terminal-body p,
        .terminal-container.is-transparent .terminal-body li,
        .terminal-container.is-transparent .terminal-body a,
        .terminal-container.is-transparent .terminal-body div {
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000 !important;
        }
        /* Re-apply glow on top of the stroke for specific colors */
        .terminal-container.is-transparent .terminal-body span[style*="var(--terminal-cyan)"],
        .terminal-container.is-transparent .terminal-body .highlight {
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 0 0 8px var(--terminal-cyan) !important;
        }
        .terminal-container.is-transparent .terminal-body span[style*="var(--terminal-green)"] {
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 0 0 8px var(--terminal-green) !important;
        }
        .terminal-container.is-transparent .terminal-body span[style*="var(--neon-pink)"] {
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 0 0 8px var(--neon-pink) !important;
        }
        .terminal-container.is-transparent .terminal-body div[style*="var(--terminal-purple-term)"] {
             text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 0 0 8px var(--terminal-purple-term) !important;
        }

        /* --- MERGED: WATERMARK CSS --- */
        #futuristic-watermark:root {
            /* Tema Gelap (Default) */
            --glow-color: hsl(186, 100%, 50%);
            --background-color: rgba(10, 25, 40, 0.85);
            --border-color: rgba(127, 255, 212, 0.3);
            --text-color: rgba(230, 255, 255, 0.95);
            --particle-base-hue: 186; /* HSL Hue untuk partikel */
            --particle-base-lightness: 60;
        }

        @keyframes slideUpFadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes logo3DFlip {
            0% { transform: rotateY(0deg); filter: brightness(1); }
            50% { transform: rotateY(180deg); filter: brightness(2) drop-shadow(0 0 8px var(--glow-color)); }
            100% { transform: rotateY(360deg); filter: brightness(1); }
        }
        
        #futuristic-watermark {
            position: fixed;
            bottom: 25px;
            left: 25px;
            padding: 8px 15px;
            min-width: 212px;
            background: var(--background-color, rgba(10, 25, 40, 0.85));
            color: var(--text-color, rgba(230, 255, 255, 0.95));
            font-family: 'Roboto Mono', monospace;
            font-weight: 500;
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            border: 1px solid var(--border-color, rgba(127, 255, 212, 0.3));
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(var(--glow-color, 127, 255, 212), 0.15), 
                        0 0 30px rgba(var(--glow-color, 127, 255, 212), 0.1),
                        inset 0 0 10px rgba(var(--glow-color, 127, 255, 212), 0.1);
            z-index: 9999;
            cursor: pointer;
            user-select: none;
            overflow: hidden;
            opacity: 0;
            animation: slideUpFadeIn 1s ease-out 0.5s forwards;
            transition: background-color 0.5s ease, color 0.5s ease, transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        }
        
        #futuristic-watermark:hover {
            transform: translateY(-5px) scale(1.03);
            border-color: rgba(var(--glow-color, 127, 255, 212), 0.8);
            box-shadow: 0 0 25px rgba(var(--glow-color, 127, 255, 212), 0.4), 
                        0 0 50px rgba(var(--glow-color, 127, 255, 212), 0.25),
                        inset 0 0 12px rgba(var(--glow-color, 127, 255, 212), 0.2);
        }

        #futuristic-watermark.light-mode {
            --glow-color: hsl(220, 90%, 60%);
            --background-color: rgba(245, 248, 252, 0.85);
            --border-color: rgba(60, 100, 150, 0.3);
            --text-color: rgba(10, 25, 40, 0.95);
            --particle-base-hue: 220;
            --particle-base-lightness: 40;
        }
        
        #particle-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .f-content-wrapper {
            position: relative;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 18px;
        }

        .f-content {
            display: flex;
            align-items: center;
            gap: 10px;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .f-content.hidden {
            opacity: 0;
            pointer-events: none;
            position: absolute;
            transform: scale(0.9);
        }

        .f-logo-container {
            width: 18px;
            height: 18px;
            transition: transform 0.4s ease;
            flex-shrink: 0;
        }

        .f-logo-container.reacting {
            animation: logo3DFlip 0.7s cubic-bezier(0.22, 1, 0.36, 1);
        }
        
        .f-logo-container svg {
            width: 100%;
            height: 100%;
            stroke: var(--glow-color, hsl(186, 100%, 50%));
            stroke-width: 8;
            transition: stroke 0.5s ease;
        }
        
        #f-watermark-text, #f-follow-message {
            transition: color 0.5s ease;
        }

        #f-watermark-text {
            font-size: 12px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        #f-follow-message {
            font-size: 11px;
            letter-spacing: 0.2px;
            font-weight: 700;
            text-align: center;
            white-space: nowrap;
        }

        /* --- MLBB theme overrides --- */
        /* Enhance navbar to match the MLBB theme */
        nav.navbar {
            background-color: rgba(11, 21, 61, 0.85);
            border-bottom: 1px solid var(--neon-pink);
            backdrop-filter: blur(10px);
        }
        /* Use heroic font for navigation items */
        .nav-item a, .nav-item button {
            font-family: 'Cinzel', 'Orbitron', sans-serif;
            letter-spacing: 0.5px;
        }
        /* Stylize portal cards with cosmic backdrop and gold glow */
        .portal-card a {
            background: rgba(11, 21, 61, 0.6);
            backdrop-filter: blur(12px);
            border-radius: 12px;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
        }
        .portal-card:hover a {
            transform: translateY(-6px) scale(1.05);
            box-shadow: 0 0 15px var(--neon-blue), 0 0 30px rgba(255, 215, 0, 0.5);
        }
        /* Buttons glow with celestial colors on hover */
        button:hover, a.button:hover {
            box-shadow: 0 0 10px var(--neon-blue), 0 0 20px var(--neon-pink);
        }
        /* Dropdown backgrounds use cosmic dark */
        .dropdown {
            background-color: rgba(11, 21, 61, 0.95);
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Canvas untuk Latar Belakang 3D -->
    <canvas id="bg-canvas"></canvas>
    <video autoplay loop muted id="bg-video" class="hidden"></video>

    <!-- Navbar -->
    <nav class="navbar fixed top-0 left-0 right-0 z-50 bg-[#05010e]/90 backdrop-blur-md border-b border-[#12092a]">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div id="logo-container" class="flex items-center cursor-pointer">
                    <div class="neon-border-pink rounded-full p-2">
                        <!-- [PERBAIKAN] Ikon diganti agar lebih sesuai tema MLBB (seperti emblem) -->
                        <i class="fas fa-shield-halved text-xl neon-text-pink"></i>
                    </div>
                    <span class="ml-3 font-bold text-xl neon-text-blue">URANUSFAZRY</span>
                </div>
 
                <!-- Nav Items -->
                <div class="hidden md:flex items-center space-x-6">
                    <div class="nav-item relative group">
                        <button class="flex items-center space-x-1 neon-text-blue neon-underline font-tech">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div class="dropdown absolute right-0 mt-2 w-80 rounded-lg p-4">
                            <h3 class="text-sm neon-text-pink mb-3 uppercase tracking-wider">Portal Management</h3>
                            <button onclick="showAddLinkModal()"
                                class="w-full py-2 neon-border-blue rounded flex items-center justify-center mb-3 hover:bg-[var(--neon-blue)] hover:text-[var(--darker-bg)] transition-all font-tech">
                                <i class="fas fa-plus mr-2"></i>Add New Portal
                            </button>

                            <h3 class="text-sm neon-text-blue mt-4 mb-3 uppercase tracking-wider">Customization</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="bg-image" class="block mb-2 text-xs uppercase tracking-wider">Background Image URL</label>
                                    <div class="flex">
                                        <input type="url" id="bg-image" class="flex-grow p-2 rounded-l-lg bg-[#12092a] border-0 focus:ring-0 font-tech"
                                            placeholder="https://example.com/image.jpg">
                                        <button onclick="setBackgroundImage()"
                                            class="px-3 py-2 bg-[var(--neon-blue)] text-[var(--darker-bg)] rounded-r-lg hover:bg-[#00c4d2] transition-all">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    </div>
                                    <div class="bg-upload-container mt-2">
                                        <label class="block text-xs uppercase tracking-wider">Upload Background Media</label>
                                        <input type="file" id="bg-upload-media" class="w-full mt-1 text-xs font-tech" accept="image/*,video/*">
                                        <button onclick="applyUploadedMedia()"
                                            class="mt-2 px-3 py-1 rounded border border-[#ff2a6d] hover:bg-[#ff2a6d]/20 transition-all text-xs font-tech">
                                            Apply Media
                                        </button>
                                    </div>
                                    <button onclick="resetBackgroundMedia()"
                                        class="mt-4 w-full text-xs px-3 py-1.5 rounded border border-gray-500 hover:bg-gray-500/20 transition-all font-tech">
                                        Reset Background
                                    </button>
                                </div>
                            </div>
                        
                            <!-- [MODIFIED] Data Management Section (PDF Removed) -->
                            <h3 class="text-sm neon-text-blue mt-4 mb-3 uppercase tracking-wider">Data Management</h3>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="importData()" class="w-full py-2 neon-border-blue rounded flex items-center justify-center hover:bg-[var(--neon-blue)] hover:text-[var(--darker-bg)] transition-all font-tech text-xs"><i class="fas fa-upload mr-1"></i>Import</button>
                                <button onclick="backupData()" class="w-full py-2 neon-border-blue rounded flex items-center justify-center hover:bg-[var(--neon-blue)] hover:text-[var(--darker-bg)] transition-all font-tech text-xs"><i class="fas fa-download mr-1"></i>Backup</button>
                            </div>

                            <!-- [MODIFIED] System Reset Button -->
                            <h3 class="text-sm neon-text-pink mt-4 mb-3 uppercase tracking-wider">System Reset</h3>
                            <button onclick="showConfirmationModal('Are you sure you want to reset everything? This will delete all custom portals and your background settings. This action cannot be undone.', resetAllSettings)"
                                class="w-full py-2 neon-border-pink rounded flex items-center justify-center mb-3 hover:bg-[var(--neon-pink)] hover:text-[var(--darker-bg)] transition-all font-tech">
                                <i class="fas fa-undo mr-2"></i>Reset All Settings
                            </button>

                            <h3 class="text-sm neon-text-blue mt-4 mb-3 uppercase tracking-wider">System Info</h3>
                            <div class="text-xs space-y-2 font-tech">
                                <div class="flex justify-between">
                                    <span>Version</span>
                                    <span class="text-[var(--neon-blue)]">v7.0.0-mlbb</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Portals</span>
                                    <span id="portal-count" class="text-[#ff2a6d]">0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="nav-item relative group">
                        <a href="https://wa.me/6287872521809?text=Halo%2C+saya+tertarik+dengan+portal+MLBB+Anda." target="_blank" class="flex items-center space-x-1 neon-text-blue neon-underline font-tech">
                            <i class="fas fa-address-card"></i>
                            <span>WhatsApp</span>
                        </a>
                    </div>
                </div>

                <!-- Mobile menu button -->
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="neon-text-pink text-2xl focus:outline-none">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile menu -->
        <div id="mobile-menu" class="md:hidden hidden bg-[#05010e] border-t border-[#ff2a6d]">
            <div class="px-2 py-3 space-y-1">
                <button onclick="showAddLinkModal()" class="block px-3 py-2 rounded-md neon-text-blue w-full text-left hover:bg-[var(--neon-blue)]/20 font-tech">
                    <i class="fas fa-plus mr-2"></i>Add New Portal
                </button>
                <a href="https://wa.me/6287872521809?text=Halo%2C+saya+tertarik+dengan+portal+MLBB+Anda." target="_blank" class="block px-3 py-2 rounded-md neon-text-blue w-full text-left hover:bg-[var(--neon-blue)]/20 font-tech">
                    <i class="fas fa-address-card mr-2"></i>WhatsApp
                </a>
                <div class="px-3 py-2">
                    <label class="block text-xs neon-text-blue mb-1">Background Image URL</label>
                    <div class="flex mb-2">
                        <input type="url" id="bg-image-mobile" class="flex-grow p-2 rounded-l-lg bg-[#12092a]"
                            placeholder="Image URL">
                        <button onclick="setBackgroundImage()"
                            class="px-3 py-2 bg-[var(--neon-blue)] text-[#0d0221] rounded-r-lg hover:bg-[#00c4d2] transition-all">
                            <i class="fas fa-check"></i>
                        </button>
                    </div>
                    <div class="bg-upload-container mt-2">
                        <label class="block text-xs uppercase tracking-wider">Upload Background Media</label>
                        <input type="file" id="bg-upload-media-mobile" class="w-full mt-1 text-xs font-tech" accept="image/*,video/*">
                        <button onclick="applyUploadedMedia()"
                            class="mt-2 px-3 py-1 rounded border border-[#ff2a6d] hover:bg-[#ff2a6d]/20 transition-all text-xs font-tech">
                            Apply Media
                        </button>
                    </div>
                    <button onclick="resetBackgroundMedia()"
                        class="w-full mt-3 px-3 py-1.5 text-xs rounded border border-gray-500 hover:bg-gray-500/20 transition-all">
                        Reset Background
                    </button>
                </div>
                <!-- [MODIFIED] Data Management for Mobile (PDF Removed) -->
                 <div class="px-3 py-2 border-t border-gray-700 mt-2">
                    <h3 class="text-sm neon-text-blue mb-2 uppercase tracking-wider">Data Management</h3>
                    <div class="grid grid-cols-2 gap-2 mb-2">
                         <button onclick="importData()" class="w-full py-2 neon-border-blue rounded flex items-center justify-center hover:bg-[var(--neon-blue)] hover:text-[var(--darker-bg)] transition-all font-tech text-xs"><i class="fas fa-upload mr-1"></i>Import</button>
                         <button onclick="backupData()" class="w-full py-2 neon-border-blue rounded flex items-center justify-center hover:bg-[var(--neon-blue)] hover:text-[var(--darker-bg)] transition-all font-tech text-xs"><i class="fas fa-download mr-1"></i>Backup</button>
                    </div>
                </div>
                <!-- [MODIFIED] Reset All Button for Mobile -->
                <div class="px-3 py-2 border-t border-gray-700 mt-2">
                     <button onclick="showConfirmationModal('Are you sure you want to reset everything? This will delete all custom portals and your background settings. This action cannot be undone.', resetAllSettings)" class="block px-3 py-2 rounded-md text-red-500 w-full text-left hover:bg-red-500/20 font-tech">
                        <i class="fas fa-undo mr-2"></i>Reset All Settings
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main container -->
    <main class="container mx-auto px-4 py-8 relative z-10 mt-20">
        <!-- Header -->
        <header class="text-center mb-12">
            <div class="profile">
                <!-- Gambar profil dipertahankan sesuai permintaan implisit (host: UranusFazry) -->
                <img src="https://i.imghippo.com/files/hkw7793vi.jpg" alt="Foto profil pribadi" onerror="this.onerror=null;this.src='https://placehold.co/120x120/0d0221/ffffff?text=UF';">
            </div>
            <div class="relative inline-block">
                <h1 class="glitch-effect text-5xl md:text-7xl font-bold mb-4" data-text="URANUS FAZRY">URANUS FAZRY</h1>
                <span
                    class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-48 h-1 bg-gradient-to-r from-transparent via-[var(--neon-blue)] to-transparent"></span>
                <span
                    class="absolute -bottom-5 left-1/2 transform -translate-x-1/2 w-32 h-1 bg-gradient-to-r from-transparent via-[var(--neon-pink)] to-transparent"></span>
            </div>
            <p class="text-lg md:text-xl neon-text-purple uppercase tracking-wider mt-8">Kumpulan Website Induk MLBB</p>
             <p class="max-w-2xl mx-auto mt-6 text-base md:text-lg text-gray-300 leading-relaxed">
                Selamat datang di portal MLBB Uranus Fazry. Temukan semua link penting, dari website resmi, esports, hingga komunitas.
            </p>
        </header>
        <!-- Time and date display -->
        <div class="flex justify-center mb-12">
            <div class="neon-border-blue rounded-lg p-4 text-center backdrop-blur-sm bg-[#0d0221]/50 holographic-effect">
                <div id="time" class="text-3xl md:text-4xl font-bold neon-text-blue">00:00:00</div>
                <div id="date" class="text-lg md:text-xl uppercase tracking-wider mt-1">Loading...</div>
            </div>
        </div>

        <!-- CYBER TERMINAL (from File 1) -->
        <div class="terminal-container">
            <div class="terminal-header">
                <div class="terminal-buttons">
                    <div class="terminal-button red"></div>
                    <div class="terminal-button yellow"></div>
                    <div class="terminal-button green"></div>
                </div>
                <div class="glitch" data-text="uranusfazry@landofdawn">uranusfazry@landofdawn</div>
                <div class="terminal-buttons">
                    <div style="width: 20px;"></div>
                </div>
            </div>
            <div class="terminal-body" id="terminal-body">
                <div id="typing-text" class="typing-text"></div>
                <div id="command-line" class="command-line hidden">
                    <span class="prompt">&gt;</span>
                    <input type="text" class="command-input" id="command-input" autocomplete="off">
                    <span class="cursor"></span>
                </div>
            </div>
        </div>
        
        <!-- Portals grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-12" id="portals-grid">
            <!-- Portals will be added here by JavaScript -->
        </div>
    </main>
    
    <footer class="text-white">
        © 2025 Created by Uranus Fazry | All Rights Reserved
    </footer>

    <div id="volume-control" class="hidden">
        <i id="volume-icon" class="fas fa-volume-mute"></i>
    </div>


    <!-- Add Portal Modal -->
    <div id="add-portal-modal" class="fixed inset-0 flex items-center justify-center z-50 hidden modal-overlay">
        <div class="modal-content neon-border-blue rounded-xl p-8 max-w-md w-full mx-4 relative">
            <button id="close-portal-modal" onclick="document.getElementById('add-portal-modal').classList.add('hidden')"
                class="absolute top-4 right-4 text-xl hover:text-[var(--neon-pink)] transition-all">×</button>
            <h2 class="text-2xl neon-text-pink mb-6 uppercase tracking-wider">Create New Portal</h2>

            <form id="portal-form" class="space-y-4">
                <div>
                    <label for="portal-name" class="block mb-2 neon-text-blue uppercase text-sm tracking-wider">Portal Name</label>
                    <input type="text" id="portal-name" class="w-full p-3 rounded-lg bg-[#12092a] border-0 focus:outline-none focus:ring-2 focus:ring-[var(--neon-blue)]" required>
                </div>

                <div>
                    <label for="portal-url" class="block mb-2 neon-text-blue uppercase text-sm tracking-wider">Destination URL</label>
                    <input type="url" id="portal-url" class="w-full p-3 rounded-lg bg-[#12092a] border-0 focus:outline-none focus:ring-2 focus:ring-[var(--neon-blue)]" placeholder="https://" required>
                </div>
                
                <div>
                    <label for="portal-description" class="block mb-2 neon-text-blue uppercase text-sm tracking-wider">Description</label>
                    <textarea id="portal-description" rows="2" class="w-full p-3 rounded-lg bg-[#12092a] border-0 focus:outline-none focus:ring-2 focus:ring-[var(--neon-blue)]" placeholder="A short description..."></textarea>
                </div>

                <div>
                    <label class="block mb-2 neon-text-blue uppercase text-sm tracking-wider">Icon</label>
                    <!-- [PERBAIKAN] Daftar ikon di-grup agar lebih rapi dan mudah dicari -->
                    <select id="portal-icon" class="w-full p-3 rounded-lg bg-[#0d0221] border border-[var(--neon-blue)] focus:outline-none focus:border focus:border-[var(--neon-pink)]">
                        <optgroup label="MLBB & Gaming">
                            <option value="fas fa-trophy">Trophy (Esports)</option>
                            <option value="fas fa-fist-raised">Fist (By One)</option>
                            <option value="fas fa-star">Star</option>
                            <option value="fas fa-shield-halved">Shield (Emblem)</option>
                            <option value="fas fa-dragon">Dragon (Lord)</option>
                            <option value="fas fa-skull">Skull (Kill)</option>
                            <option value="fas fa-gamepad">Gamepad</option>
                            <option value="fas fa-gem">Gem (Diamond)</option>
                            <option value="fas fa-users">Users (Squad)</option>
                        </optgroup>
                        <optgroup label="Sosial & Merek">
                            <option value="fab fa-youtube">YouTube</option>
                            <option value="fab fa-tiktok">TikTok</option>
                            <option value="fab fa-instagram">Instagram</option>
                            <option value="fab fa-facebook">Facebook</option>
                            <option value="fab fa-twitter">Twitter</option>
                            <option value="fab fa-discord">Discord</option>
                            <option value="fab fa-whatsapp">WhatsApp</option>
                            <option value="fab fa-telegram">Telegram</option>
                            <option value="fab fa-reddit">Reddit</option>
                            <option value="fab fa-twitch">Twitch</option>
                            <option value="fab fa-spotify">Spotify</option>
                        </optgroup>
                        <optgroup label="Umum & Tautan">
                            <option value="fas fa-link">Default Link</option>
                            <option value="fas fa-globe">Globe</option>
                            <option value="fas fa-store">Store</option>
                            <option value="fas fa-newspaper">Newspaper</option>
                            <option value="fas fa-envelope">Envelope</option>
                            <option value="fas fa-book">Book</option>
                            <option value="fas fa-wallet">Wallet</option>
                            <option value="fas fa-shopping-cart">Shopping Cart</option>
                            <option value="fas fa-music">Music</option>
                            <option value="fas fa-home">Home</option>
                            <option value="fas fa-video">Video</option>
                            <option value="fas fa-image">Image</option>
                            <option value="fas fa-user">User</option>
                        </optgroup>
                        <optgroup label="Teknologi & Kode">
                            <option value="fas fa-desktop">Desktop</option>
                            <option value="fas fa-mobile-alt">Mobile</option>
                            <option value="fas fa-laptop-code">Laptop Code</option>
                            <option value="fas fa-terminal">Terminal</option>
                            <option value="fas fa-code">Code</option>
                            <option value="fas fa-server">Server</option>
                            <option value="fas fa-database">Database</option>
                            <option value="fab fa-github">GitHub</option>
                            <option value="fas fa-chart-line">Chart Line</option>
                            <option value="fab fa-bitcoin">Bitcoin</option>
                            <option value="fas fa-microchip">Microchip</option>
                        </optgroup>
                        <optgroup label="Lainnya">
                            <option value="fas fa-fire">Fire</option>
                            <option value="fas fa-magic">Magic</option>
                            <option value="fas fa-rocket">Rocket</option>
                            <option value="fas fa-atom">Atom</option>
                            <option value="custom-icon">Custom Icon</option>
                        </optgroup>
                    </select>
 
                    <div id="custom-icon-options" class="custom-icon-option mt-3" style="display: none;">
                        <div class="flex space-x-4">
                            <div class="flex-1">
                                <label class="block mb-2 text-xs uppercase tracking-wider">Upload Icon</label>
                                <input type="file" id="icon-upload" class="w-full text-xs" accept="image/*">
                            </div>
                            <div class="flex-1">
                                <label class="block mb-2 text-xs uppercase tracking-wider">Icon URL</label>
                                <input type="url" id="icon-url" class="w-full p-2 rounded bg-[#0d0221]" placeholder="https://example.com/icon.png">
                            </div>
                        </div>
                        <img id="icon-preview" class="icon-preview" src="#" alt="Icon Preview">
                    </div>
                </div>

                <div>
                    <label class="block mb-2 neon-text-blue uppercase text-sm tracking-wider">Color</label>
                    <div class="color-picker-container text-center neon-border-blue rounded-lg p-2">
                        <div class="color-option" style="background-color: #ff2a6d;" onclick="selectPortalColor('#ff2a6d', this)"></div>
                        <div class="color-option selected" style="background-color: #05d9e8;" onclick="selectPortalColor('#05d9e8', this)"></div>
                        <div class="color-option" style="background-color: #d300c5;" onclick="selectPortalColor('#d300c5', this)"></div>
                        <div class="color-option" style="background-color: #00ff9d;" onclick="selectPortalColor('#00ff9d', this)"></div>
                        <div class="color-option" style="background-color: #ffcc00;" onclick="selectPortalColor('#ffcc00', this)"></div>
                        <div class="color-option" style="background-color: #ffffff;" onclick="selectPortalColor('#ffffff', this)"></div>
                        <div class="color-option" style="background-color: #1DA1F2;" onclick="selectPortalColor('#1DA1F2', this)"></div>
                        <div class="color-option" style="background-color: #FF5700;" onclick="selectPortalColor('#FF5700', this)"></div>
                        <input type="color" id="portal-custom-color" class="custom-color-input w-full h-8 mt-2" onchange="applyCustomPortalColor(this.value)">
                    </div>
                    <input type="hidden" id="portal-color" value="#05d9e8">
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="document.getElementById('add-portal-modal').classList.add('hidden')"
                        class="px-4 py-2 rounded-lg border border-[var(--neon-pink)] hover:bg-[var(--neon-pink)] hover:text-white transition-all">
                        Cancel
                    </button>
                    <button type="submit"
                        class="px-6 py-2 neon-border-blue rounded-lg hover:bg-[var(--neon-blue)] hover:text-[#0d0221] transition-all font-bold">
                        Create Portal
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- [NEW] Confirmation Modal -->
    <div id="confirmation-modal" class="fixed inset-0 flex items-center justify-center z-[60] hidden modal-overlay">
        <div class="modal-content neon-border-pink rounded-xl p-8 max-w-sm w-full mx-4 relative text-center">
             <h2 class="text-xl neon-text-pink mb-4">Confirm Action</h2>
             <p id="confirmation-message" class="mb-6 text-gray-300">Are you sure?</p>
             <div class="flex justify-center space-x-4">
                 <button id="confirm-cancel-btn" class="px-6 py-2 rounded-lg border border-gray-500 hover:bg-gray-500/20 transition-all font-bold">
                     Cancel
                 </button>
                 <button id="confirm-ok-btn" class="px-6 py-2 neon-border-pink rounded-lg hover:bg-[var(--neon-pink)] hover:text-[#0d0221] transition-all font-bold">
                     Confirm
                 </button>
             </div>
        </div>
    </div>

    <!-- [NEW] Audio Player Element -->
    <audio id="audio-player"></audio>
    
    <!-- [NEW] Hidden file input for import -->
    <input type="file" id="import-file-input" class="hidden" accept=".txt,application/json">


    <script>
        // --- SCRIPT UTAMA PORTAL ---
        document.addEventListener('DOMContentLoaded', async function() {
            // --- NEON PORTAL SCRIPT (File 1) ---
            const portalsGrid = document.getElementById('portals-grid');
            const portalForm = document.getElementById('portal-form');
            const portalCount = document.getElementById('portal-count');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            const timeDisplay = document.getElementById('time');
            const dateDisplay = document.getElementById('date');
            const portalIconSelect = document.getElementById('portal-icon');
            const customIconOptions = document.getElementById('custom-icon-options');
            const iconUpload = document.getElementById('icon-upload');
            const iconPreview = document.getElementById('icon-preview');
            const bgVideo = document.getElementById('bg-video');
            const volumeControl = document.getElementById('volume-control');
            const volumeIcon = document.getElementById('volume-icon');
            const logoContainer = document.getElementById('logo-container');
            const bgUploadMedia = document.getElementById('bg-upload-media');
            const bgUploadMediaMobile = document.getElementById('bg-upload-media-mobile');
            const audioPlayer = document.getElementById('audio-player');
            // [NEW] Import file input
            const importFileInput = document.getElementById('import-file-input');
            // [NEW] Confirmation Modal elements
            const confirmationModal = document.getElementById('confirmation-modal');
            const confirmationMessage = document.getElementById('confirmation-message');
            const confirmOkBtn = document.getElementById('confirm-ok-btn');
            const confirmCancelBtn = document.getElementById('confirm-cancel-btn');


            let portals = [];
            let currentBgImage = '';
            let currentBgVideo = '';
            let selectedMediaFile = null;
            let onConfirmCallback = null; // To store the action for the confirmation modal
            
            // --- [NEW] Variables for swipe/drag gestures ---
            let touchStartX = 0; 
            let dragStartX = 0;
            let isDragging = false;
            
            // --- [NEW] IndexedDB Helper Functions ---
            const DB_NAME = 'uranusfazryDB';
            const STORE_NAME = 'mediaFiles';
            const FILE_KEY = 'userBackgroundMedia';
            let db;

            // Function to open/create the database
            async function openDB() {
                return new Promise((resolve, reject) => {
                    if (db) return resolve(db);
                    const request = indexedDB.open(DB_NAME, 1);
                    request.onerror = (event) => reject("Error opening IndexedDB.");
                    request.onsuccess = (event) => {
                        db = event.target.result;
                        resolve(db);
                    };
                    request.onupgradeneeded = (event) => {
                        const dbInstance = event.target.result;
                        if (!dbInstance.objectStoreNames.contains(STORE_NAME)) {
                            dbInstance.createObjectStore(STORE_NAME);
                        }
                    };
                });
            }

            // Function to save a file to the database
            async function saveFileToDB(file) {
                const db = await openDB();
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([STORE_NAME], 'readwrite');
                    const store = transaction.objectStore(STORE_NAME);
                    const request = store.put(file, FILE_KEY);
                    request.onsuccess = () => resolve();
                    request.onerror = (event) => reject("Failed to save file: " + event.target.error);
                });
            }

            // Function to retrieve a file from the database
            async function getFileFromDB() {
                const db = await openDB();
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([STORE_NAME], 'readonly');
                    const store = transaction.objectStore(STORE_NAME);
                    const request = store.get(FILE_KEY);
                    request.onsuccess = (event) => resolve(event.target.result);
                    request.onerror = (event) => reject("Failed to get file: " + event.target.error);
                });
            }

            // Function to delete a file from the database
            async function deleteFileFromDB() {
                const db = await openDB();
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([STORE_NAME], 'readwrite');
                    const store = transaction.objectStore(STORE_NAME);
                    const request = store.delete(FILE_KEY);
                    request.onsuccess = () => resolve();
                    request.onerror = (event) => reject("Failed to delete file: " + event.target.error);
                });
            }
            // --- End of IndexedDB Helpers ---

            const musicList = [
                { name: 'Chammak Challo', url: 'https://c.top4top.io/m_3457ukcau0.mp3' },
                { name: 'Chammak Challo 2', url: 'https://i.top4top.io/m_3510lx6lu0.m4a' },
                { name: 'DJ CAMPURAN VIRAL', url: 'https://h.top4top.io/m_345748hje1.mp3' },
                { name: 'DJ CAMPURAN VIRAL 2', url: 'https://h.top4top.io/m_3483c2rkf1.m4a' },
                { name: 'DJ CAMPURAN VIRAL 3', url: 'https://h.top4top.io/m_34894tuhu1.m4a' },
                { name: 'DJ CAMPURAN VIRAL 4', url: 'https://k.top4top.io/m_3458s4twa1.m4a' },
                { name: 'DJ CAMPURAN VIRAL 5', url: 'https://e.top4top.io/m_3504ymzax0.m4a' }
            ];

            // --- [MODIFIED] Portal default diganti ke tema MLBB ---
            const defaultPortals = [
                { name: 'MLBB Official', url: 'https://m.mobilelegends.com/en', icon: 'fas fa-globe', color: '#68c5ff', description: 'Website resmi Mobile Legends: Bang Bang.' },
                { name: 'MLBB Esports', url: 'https://esports.mobilelegends.com/', icon: 'fas fa-trophy', color: '#ffd700', description: 'Info turnamen, tim, dan jadwal MPL.' },
                { name: 'MLBB Fandom Wiki', url: 'https://mobile-legends.fandom.com/wiki/Mobile_Legends_Bang_Bang_Wiki', icon: 'fas fa-book', color: '#00ff9d', description: 'Database hero, item, dan skin terlengkap.' },
                { name: 'Liquipedia MLBB', url: 'https://liquipedia.net/mobilelegends/', icon: 'fas fa-newspaper', color: '#ffffff', description: 'Wiki e-sports untuk scene kompetitif MLBB.' },
                { name: 'MLBB Reddit', url: 'https://www.reddit.com/r/MobileLegendsGame/', icon: 'fab fa-reddit', color: '#FF5700', description: 'Diskusi komunitas, tips, dan meme.' },
                { name: 'Official YouTube', url: 'https://www.youtube.com/@MobileLegends5v5BangBang', icon: 'fab fa-youtube', color: '#ff0000', description: 'Channel YouTube resmi MLBB.' },
                { name: 'Official Instagram', url: 'https://www.instagram.com/mobilelegends_id/', icon: 'fab fa-instagram', color: '#d300c5', description: 'Update harian dan event via Instagram.' },
                { name: 'Official TikTok', url: 'https://www.tiktok.com/@mobilelegends_id', icon: 'fab fa-tiktok', color: '#000000', description: 'Konten video pendek resmi.' },
                { name: 'Top Up / Codashop', url: 'https://www.codashop.com/id-id/mobile-legends', icon: 'fas fa-gem', color: '#f7931a', description: 'Beli Diamonds dan Starlight member.' },
                { name: 'By One (UranusFazry)', url: 'https://website-induk.vercel.app/', icon: 'fas fa-fist-raised', color: '#ff2a6d', description: 'Tantang Raja By One? Klik di sini.' },
                { name: 'Testimoni By One', url: 'https://testimoni-dun.vercel.app', icon: 'fas fa-star', color: '#ffcc00', description: 'Lihat hasil by one melawan UranusFazry.' }
            ];

            async function initPortalApp() {
                portals = JSON.parse(localStorage.getItem('portals')) || defaultPortals;
                currentBgImage = localStorage.getItem('bgImage') || '';
                
                // [MODIFIED] Load from IndexedDB first, which overrides localStorage image
                try {
                    const storedFile = await getFileFromDB();
                    if (storedFile) {
                        const fileUrl = URL.createObjectURL(storedFile);
                        if (storedFile.type.startsWith('image/')) {
                            currentBgImage = fileUrl;
                            currentBgVideo = '';
                        } else if (storedFile.type.startsWith('video/')) {
                            currentBgVideo = fileUrl;
                            currentBgImage = '';
                        }
                    }
                } catch (error) {
                    console.error("Could not load media from DB:", error);
                }

                renderPortals();
                updateTime();
                setInterval(updateTime, 1000);
                loadBackgroundMedia();
                
                mobileMenuButton.addEventListener('click', () => {
                    const isOpening = mobileMenu.classList.contains('hidden');
                    mobileMenu.classList.toggle('hidden');
                    document.body.classList.toggle('overflow-hidden', !mobileMenu.classList.contains('hidden'));
                    if (isOpening) {
                        bgUploadMediaMobile.value = '';
                        selectedMediaFile = null;
                    }
                });

                portalForm.addEventListener('submit', handlePortalFormSubmit);
                portalIconSelect.addEventListener('change', () => {
                    customIconOptions.style.display = (portalIconSelect.value === 'custom-icon') ? 'block' : 'none';
                });
                
                iconUpload.addEventListener('change', (e) => handleImageUpload(e, iconPreview));
                volumeControl.addEventListener('click', toggleMute);
                logoContainer.addEventListener('click', togglePreviewMode);
                
                bgUploadMedia.addEventListener('change', handleMediaSelect);
                bgUploadMediaMobile.addEventListener('change', handleMediaSelect);

                // --- [MODIFIED] Add all gesture event listeners ---
                document.body.addEventListener('touchstart', handleTouchStart, false);
                document.body.addEventListener('touchend', handleTouchEnd, false);
                document.body.addEventListener('mousedown', handleDragStart);
                document.body.addEventListener('mouseup', handleDragEnd);
                document.body.addEventListener('mouseleave', handleDragLeave);
                
                // [NEW] Add event listener for the import file input
                importFileInput.addEventListener('change', handleFileImport);
                
                // [NEW] Add event listeners for confirmation modal
                confirmCancelBtn.addEventListener('click', () => confirmationModal.classList.add('hidden'));
                confirmOkBtn.addEventListener('click', () => {
                    if (typeof onConfirmCallback === 'function') {
                        onConfirmCallback();
                    }
                    confirmationModal.classList.add('hidden');
                    onConfirmCallback = null;
                });
            }
            
            // [NEW] Show Confirmation Modal Function
            window.showConfirmationModal = function(message, callback) {
                confirmationMessage.textContent = message;
                onConfirmCallback = callback;
                confirmationModal.classList.remove('hidden');
            }

            // --- [NEW] GESTURE HANDLER FUNCTIONS ---

            function handleTouchStart(event) {
                if (document.body.classList.contains('preview-mode-active')) {
                    touchStartX = event.touches[0].clientX;
                }
            }

            function handleTouchEnd(event) {
                if (document.body.classList.contains('preview-mode-active')) {
                    const touchEndX = event.changedTouches[0].clientX;
                    if (touchStartX - touchEndX > 75) { // Swipe left
                        togglePreviewMode();
                    }
                }
            }

            function handleDragStart(event) {
                if (document.body.classList.contains('preview-mode-active')) {
                    isDragging = true;
                    dragStartX = event.clientX;
                    event.preventDefault(); // Prevent text selection
                }
            }

            function handleDragEnd(event) {
                if (isDragging && document.body.classList.contains('preview-mode-active')) {
                    const dragEndX = event.clientX;
                    if (dragStartX - dragEndX > 100) { // Swipe left with mouse
                        togglePreviewMode();
                    }
                }
                isDragging = false;
            }
            
            function handleDragLeave() {
                if (isDragging) {
                    isDragging = false;
                }
            }
            // --- END OF GESTURE HANDLERS ---


            function handleMediaSelect(event) {
                const file = event.target.files[0];
                if (file) {
                    selectedMediaFile = file;
                }
            }

            window.handleImageUpload = function(event, previewElement) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewElement.src = e.target.result;
                        previewElement.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            }
            
            function renderPortals() {
                portalsGrid.innerHTML = '';
                
                portals.forEach((portal, index) => {
                    const portalElement = document.createElement('div');
                    portalElement.className = 'h-full';
                    
                    const portalColor = portal.color || '#ffffff';
                    const textColorStyle = `color: ${portalColor}; text-shadow: 0 0 5px ${portalColor}, 0 0 10px ${portalColor};`;
                    const borderStyle = `border: 1px solid ${portalColor}; box-shadow: 0 0 5px ${portalColor}, inset 0 0 5px ${portalColor}, 0 0 10px ${portalColor};`;
                    
                    const iconHtml = portal.icon.startsWith('data:image') || portal.icon.startsWith('http')
                        ? `<img src="${portal.icon}" class="mx-auto h-12 w-12 mb-4 object-contain" alt="${portal.name} icon">`
                        : `<i class="${portal.icon} text-4xl mb-4" style="${textColorStyle}"></i>`;

                    portalElement.innerHTML = `
                        <div class="portal-card h-full" style="color: ${portalColor};">
                            <a href="${portal.url}" target="_blank" class="block h-full p-6 rounded-lg text-center relative overflow-hidden backdrop-blur-sm bg-[#0d0221]/50 transition-all duration-300 flex flex-col" style="${borderStyle}">
                                <div class="portal-card-inner flex flex-col justify-center items-center flex-grow">
                                    ${iconHtml}
                                    <h3 class="font-bold uppercase tracking-wider break-words text-lg" style="${textColorStyle}">${portal.name}</h3>
                                    <p class="text-sm text-gray-300 mt-2 leading-normal">${portal.description || ''}</p>
                                </div>
                                <button onclick="showConfirmationModal('Are you sure you want to delete this portal?', () => deletePortalAction(${index}))" 
                                    class="absolute top-2 right-2 text-xs text-red-500 hover:text-red-400 opacity-50 hover:opacity-100 transition-opacity z-10">
                                    <i class="fas fa-times"></i>
                                </button>
                            </a>
                        </div>
                    `;
                    // Add event listener to prevent the default link behavior when the delete button is clicked
                    portalElement.querySelector('button').addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                    });
                    
                    portalsGrid.appendChild(portalElement);
                });
                
                portalCount.textContent = portals.length;
            }
            
            function handlePortalFormSubmit(e) {
                e.preventDefault();
                
                const name = document.getElementById('portal-name').value;
                const url = document.getElementById('portal-url').value;
                const description = document.getElementById('portal-description').value;
                let icon = document.getElementById('portal-icon').value;
                const color = document.getElementById('portal-color').value;
                
                if (icon === 'custom-icon') {
                    const iconUrlInput = document.getElementById('icon-url');
                    const iconFileInput = document.getElementById('icon-upload');
                    
                    if (iconUrlInput.value) {
                        addPortalToArray(name, url, iconUrlInput.value, color, description);
                    } else if (iconFileInput.files[0]) {
                        const reader = new FileReader();
                        reader.onload = (event) => addPortalToArray(name, url, event.target.result, color, description);
                        reader.readAsDataURL(iconFileInput.files[0]);
                    } else {
                        addPortalToArray(name, url, 'fas fa-link', color, description); // Fallback
                    }
                } else {
                    addPortalToArray(name, url, icon, color, description);
                }
            }
            
            function addPortalToArray(name, url, icon, color, description) {
                portals.push({ name, url, icon, color, description });
                savePortals();
                renderPortals();
                document.getElementById('add-portal-modal').classList.add('hidden');
                resetPortalForm();
            }
            
            // [MODIFIED] This is the actual deletion logic, called by the modal
            window.deletePortalAction = function(index) {
                portals.splice(index, 1);
                savePortals();
                renderPortals();
            }
            
            function resetPortalForm() {
                portalForm.reset();
                customIconOptions.style.display = 'none';
                if(iconPreview) {
                    iconPreview.style.display = 'none';
                    iconPreview.src = '#';
                }
                document.getElementById('portal-color').value = '#05d9e8';
                const colorOptions = document.querySelectorAll('#add-portal-modal .color-option');
                colorOptions.forEach(el => el.classList.remove('selected'));
                colorOptions[1].classList.add('selected');
            }
            
            function savePortals() {
                localStorage.setItem('portals', JSON.stringify(portals));
            }
            
            window.showAddLinkModal = function() {
                document.getElementById('add-portal-modal').classList.remove('hidden');
                if (!mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.add('hidden');
                    document.body.classList.remove('overflow-hidden');
                }
            }
            
            function updateTime() {
                const now = new Date();
                timeDisplay.textContent = now.toLocaleTimeString('en-GB');
                dateDisplay.textContent = now.toLocaleDateString('id-ID', { 
                    weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
                });
            }
            
            window.selectPortalColor = function(color, element) {
                const container = element.closest('.color-picker-container');
                container.querySelectorAll('.color-option').forEach(el => el.classList.remove('selected'));
                element.classList.add('selected');
                document.getElementById('portal-color').value = color;
            }

            window.applyCustomPortalColor = function(color) {
                document.getElementById('portal-color').value = color;
                const container = document.getElementById('add-portal-modal');
                container.querySelectorAll('.color-option').forEach(el => el.classList.remove('selected'));
            }
            
            // [MODIFIED] Set background from URL, clears file from DB
            window.setBackgroundImage = async function() {
                const bgUrlInput = document.getElementById('bg-image-mobile').value ? document.getElementById('bg-image-mobile') : document.getElementById('bg-image');
                if (bgUrlInput && bgUrlInput.value) {
                    try {
                        await deleteFileFromDB();
                    } catch(e) { console.error("Could not clear DB file when setting URL", e); }
                    updateBackgroundMedia(bgUrlInput.value, null);
                }
            }

            // [MODIFIED] Apply uploaded file, saves to DB
            window.applyUploadedMedia = async function() {
                if (!selectedMediaFile) return;

                try {
                    await saveFileToDB(selectedMediaFile);
                    localStorage.removeItem('bgImage'); // Clear URL from localStorage

                    const storedFile = await getFileFromDB();
                    if (storedFile) {
                        const fileUrl = URL.createObjectURL(storedFile);
                        if (storedFile.type.startsWith('image/')) {
                            updateBackgroundMedia(fileUrl, null);
                        } else if (storedFile.type.startsWith('video/')) {
                            updateBackgroundMedia(null, fileUrl);
                        }
                    }
                } catch (error) {
                    console.error("Failed to apply uploaded media:", error);
                    alert("Sorry, could not save the media file. It might be too large or your browser has storage restrictions.");
                }

                bgUploadMedia.value = '';
                bgUploadMediaMobile.value = '';
                selectedMediaFile = null;

                if (!mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.add('hidden');
                    document.body.classList.remove('overflow-hidden');
                }
            }

            // [MODIFIED] Central function to update media state
            function updateBackgroundMedia(imageUrl, videoUrl) {
                // Revoke old blob URLs to prevent memory leaks
                if (currentBgVideo && currentBgVideo.startsWith('blob:')) {
                    URL.revokeObjectURL(currentBgVideo);
                }
                if (currentBgImage && currentBgImage.startsWith('blob:')) {
                    URL.revokeObjectURL(currentBgImage);
                }

                if (imageUrl) {
                    currentBgImage = imageUrl;
                    currentBgVideo = '';
                    if (!imageUrl.startsWith('blob:')) {
                        localStorage.setItem('bgImage', currentBgImage);
                    }
                } else if (videoUrl) {
                    currentBgImage = '';
                    currentBgVideo = videoUrl;
                }
                loadBackgroundMedia();
            }
            
            function loadBackgroundMedia() {
                document.body.classList.remove('has-bg-media');
                bgVideo.classList.add('hidden');
                document.body.style.setProperty('--bg-image', 'none');
                volumeControl.classList.add('hidden');

                if (currentBgVideo) {
                    document.body.classList.add('has-bg-media');
                    bgVideo.src = currentBgVideo;
                    bgVideo.classList.remove('hidden');
                    bgVideo.muted = true; 
                    bgVideo.play().catch(e => console.error("Video play failed:", e));
                    volumeControl.classList.remove('hidden');
                    updateVolumeIcon();
                } else if (currentBgImage) {
                    document.body.classList.add('has-bg-media');
                    document.body.style.setProperty('--bg-image', `url('${currentBgImage}')`);
                }
                
                const terminalContainer = document.querySelector('.terminal-container');
                if(terminalContainer) {
                    terminalContainer.classList.toggle('is-transparent', !!currentBgImage || !!currentBgVideo);
                }
            }
            
            // [MODIFIED] Reset now also clears the IndexedDB
            window.resetBackgroundMedia = async function() {
                if(currentBgVideo && currentBgVideo.startsWith('blob:')) {
                    URL.revokeObjectURL(currentBgVideo);
                }
                 if(currentBgImage && currentBgImage.startsWith('blob:')) {
                    URL.revokeObjectURL(currentBgImage);
                }
                bgVideo.pause();
                bgVideo.removeAttribute('src');

                currentBgImage = '';
                currentBgVideo = '';
                localStorage.removeItem('bgImage');
                
                try {
                    await deleteFileFromDB();
                } catch (error) {
                    console.error("Failed to delete media from DB:", error);
                }
                
                loadBackgroundMedia();
                
                document.querySelectorAll('input[type="url"]').forEach(input => input.value = '');
                document.querySelectorAll('input[type="file"]').forEach(input => input.value = '');

                if (!mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.add('hidden');
                    document.body.classList.remove('overflow-hidden');
                }
            }

            // [MODIFIED] Reset All now also clears the IndexedDB
            window.resetAllSettings = async function() {
                localStorage.removeItem('portals');
                localStorage.removeItem('bgImage');

                try {
                    await deleteFileFromDB();
                } catch (error) {
                    console.error("Failed to delete media from DB during full reset:", error);
                }

                location.reload();
            }

            function toggleMute() {
                bgVideo.muted = !bgVideo.muted;
                updateVolumeIcon();
            }

            function updateVolumeIcon() {
                if (bgVideo.muted) {
                    volumeIcon.classList.remove('fa-volume-up');
                    volumeIcon.classList.add('fa-volume-mute');
                } else {
                    volumeIcon.classList.remove('fa-volume-mute');
                    volumeIcon.classList.add('fa-volume-up');
                }
            }

            function togglePreviewMode() {
                // Only allow entering preview mode if there is a background
                if (!document.body.classList.contains('preview-mode-active') && !currentBgImage && !currentBgVideo) {
                    return; 
                }
                document.body.classList.toggle('preview-mode-active');
            }
            
            // --- [NEW] DATA MANAGEMENT FUNCTIONS ---

            // Helper function to convert a file/blob to a base64 string
            function fileToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = error => reject(error);
                });
            }

            // Helper function to convert a base64 data URL back to a Blob
            function base64ToBlob(base64, mimeType) {
                const byteCharacters = atob(base64.split(',')[1]);
                const byteNumbers = new Array(byteCharacters.length);
                for (let i = 0; i < byteCharacters.length; i++) {
                    byteNumbers[i] = byteCharacters.charCodeAt(i);
                }
                const byteArray = new Uint8Array(byteNumbers);
                return new Blob([byteArray], { type: mimeType });
            }
            
            // Backup to JSON (.txt file) with base64 media
            window.backupData = async () => {
                const dataToBackup = {
                    portals: JSON.parse(localStorage.getItem('portals')) || defaultPortals,
                    bgImage: localStorage.getItem('bgImage') || null,
                    bgMedia: null // New field for the media file
                };

                try {
                    const storedFile = await getFileFromDB();
                    if (storedFile) {
                        const base64Data = await fileToBase64(storedFile);
                        dataToBackup.bgMedia = {
                            type: storedFile.type,
                            data: base64Data
                        };
                        dataToBackup.bgImage = null; // Prioritize media file over URL
                    }
                } catch (error) {
                    console.error("Could not read media file for backup:", error);
                }
                
                const dataStr = JSON.stringify(dataToBackup, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'text/plain' });
                const url = URL.createObjectURL(dataBlob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = 'uranusfazry_backup.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            // Import from JSON (.txt file) with base64 media
            window.importData = () => {
                importFileInput.click();
            };

            async function handleFileImport(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = async (e) => {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        if (importedData && Array.isArray(importedData.portals)) {
                            // Clear old media first
                            await deleteFileFromDB();
                            localStorage.removeItem('bgImage');

                            localStorage.setItem('portals', JSON.stringify(importedData.portals));

                            if (importedData.bgMedia && importedData.bgMedia.data) {
                                // Handle imported media file
                                const mediaBlob = base64ToBlob(importedData.bgMedia.data, importedData.bgMedia.type);
                                await saveFileToDB(mediaBlob);
                            } else if (typeof importedData.bgImage === 'string') {
                                // Handle imported URL
                                localStorage.setItem('bgImage', importedData.bgImage);
                            }

                            showConfirmationModal('Data imported successfully. The page will now reload to apply changes.', () => {
                                location.reload();
                            });
                        } else {
                            alert('Invalid backup file format.');
                        }
                    } catch (error) {
                        console.error('Error parsing backup file:', error);
                        alert('Could not read the backup file. It may be corrupted or in the wrong format.');
                    }
                };
                reader.readAsText(file);
                // Reset file input to allow importing the same file again
                event.target.value = '';
            }


            // --- 3D BACKGROUND SCRIPT (File 1) ---
            function init3DBackground() {
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({
                    canvas: document.querySelector('#bg-canvas'),
                    alpha: true
                });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                
                camera.position.z = 50;

                const particleCount = 200;
                const particles = new THREE.BufferGeometry();
                const posArray = new Float32Array(particleCount * 3);
                const velocities = [];

                for (let i = 0; i < particleCount * 3; i++) {
                    posArray[i] = (Math.random() - 0.5) * 200; // Increased range
                    velocities.push((Math.random() - 0.5) * 0.1);
                }

                particles.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

                const particleMaterial = new THREE.PointsMaterial({
                    size: 0.2,
                    color: 0x68c5ff,  // updated to MLBB blue
                    transparent: true,
                    blending: THREE.AdditiveBlending
                });
                const particleMesh = new THREE.Points(particles, particleMaterial);
                scene.add(particleMesh);

                const lineGeometry = new THREE.BufferGeometry();
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: 0xffd700, // updated to MLBB gold
                    transparent: true,
                    opacity: 0.1
                });
                const lineMesh = new THREE.LineSegments(lineGeometry, lineMaterial);
                scene.add(lineMesh);
                
                const mouse = new THREE.Vector2();
                window.addEventListener('mousemove', (event) => {
                    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
                });
                
                window.addEventListener('resize', () => {
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                });

                const clock = new THREE.Clock();
                const animate = () => {
                    const elapsedTime = clock.getElapsedTime();
                    
                    const positions = particles.attributes.position.array;
                    for(let i = 0; i < particleCount; i++) {
                        positions[i * 3] += velocities[i * 3] * 0.1;
                        positions[i * 3 + 1] += velocities[i * 3 + 1] * 0.1;
                        positions[i * 3 + 2] += velocities[i * 3 + 2] * 0.1;
                        
                        // Make particles wrap around the screen
                        if (positions[i*3+1] < -100) positions[i*3+1] = 100;
                        if (positions[i*3] > 100) positions[i*3] = -100;
                        else if (positions[i*3] < -100) positions[i*3] = 100;
                    }
                    particles.attributes.position.needsUpdate = true;
                    
                    const linePositions = [];
                    for (let i = 0; i < particleCount; i++) {
                        for (let j = i + 1; j < particleCount; j++) {
                            const p1 = new THREE.Vector3(positions[i*3], positions[i*3+1], positions[i*3+2]);
                            const p2 = new THREE.Vector3(positions[j*3], positions[j*3+1], positions[j*3+2]);
                            const distance = p1.distanceTo(p2);

                            if (distance < 15) { // Increased connection distance
                                linePositions.push(p1.x, p1.y, p1.z);
                                linePositions.push(p2.x, p2.y, p2.z);
                            }
                        }
                    }
                    lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute(linePositions, 3));
                    lineGeometry.attributes.position.needsUpdate = true;

                    camera.position.x += (mouse.x * 5 - camera.position.x) * 0.02;
                    camera.position.y += (mouse.y * 5 - camera.position.y) * 0.02;
                    camera.lookAt(scene.position);
                    
                    particleMesh.rotation.y = elapsedTime * 0.05;

                    renderer.render(scene, camera);
                    window.requestAnimationFrame(animate);
                };

                animate();
            }

            // --- [MODIFIED] CYBER TERMINAL SCRIPT (File 1) ---
            const terminalBody = document.getElementById('terminal-body');
            const terminalText = document.getElementById('typing-text');
            const commandLine = document.getElementById('command-line');
            const commandInput = document.getElementById('command-input');
            
            // Fungsi ini tidak lagi menampilkan foto spesifik, biarkan foto profil utama yang berbicara
            function displayProfilePhoto() {
                // Foto sudah ada di header, tidak perlu duplikat di terminal
                // Jika ingin menambahkan foto hero MLBB, bisa di sini.
                // const imgContainer = document.createElement('div');
                // ...
                // terminalText.appendChild(imgContainer);
                // terminalBody.scrollTop = terminalBody.scrollHeight;
            }

            // --- [MODIFIED] Teks terminal diganti ke tema MLBB ---
            const messages = [
                { text: "Initializing Land of Dawn connection...", delay: 50 },
                { text: "Loading player data...", delay: 50 },
                { text: "██████████████ 100%", delay: 30, style: "color: var(--terminal-cyan)" },
                { text: "\n", delay: 200 },
                { text: "> Welcome to LAND OF DAWN TERMINAL // ACCESS GRANTED", delay: 10, style: "color: var(--terminal-green); font-weight: bold" },
                { text: "\n\n", delay: 100 },
                { text: ">> PLAYER PROFILE <<", delay: 10, style: "color: var(--terminal-purple-term); text-decoration: underline" },
                { text: "\n", delay: 100 },
                // { action: 'addPhoto', delay: 200 }, // Dihapus agar tidak duplikat
                { text: "> IGN: ", delay: 20 },
                { text: "URANUS FAZRY", delay: 50, style: "color: var(--terminal-cyan); font-weight: bold" },
                { text: "\n", delay: 50 },
                { text: "> TITLE: ", delay: 20 },
                { text: "MYTHICAL GLORY PLAYER", delay: 50, style: "color: var(--terminal-cyan)" },
                { text: "\n", delay: 50 },
                { text: "> LOCATION: ", delay: 20 },
                { text: "LAND OF DAWN", delay: 70, style: "color: var(--terminal-red)" },
                { text: "\n\n", delay: 100 },
                { text: ">> HERO MASTERY <<", delay: 10, style: "color: var(--terminal-purple-term); text-decoration: underline" },
                { text: "\n", delay: 100 },
                { text: "> ASSASSIN:  █████████▉ 95%\n", delay: 20, style: "color: var(--terminal-cyan)" },
                { text: "> MARKSMAN:  ██████████ 97%\n", delay: 20, style: "color: var(--terminal-cyan)" },
                { text: "> MAGE:      ████████▉  88%\n", delay: 20, style: "color: var(--terminal-cyan)" },
                { text: "> TANK:      ████████▊  86%\n", delay: 20, style: "color: var(--terminal-cyan)" },
                { text: "> FIGHTER:   ███████▍   75%\n", delay: 20, style: "color: var(--terminal-cyan)" },
                { text: "> SUPPORT:   ██████▎    70%\n", delay: 20, style: "color: var(--terminal-cyan)" },
                { text: "\n", delay: 100 },
                { text: ">> BATTLE LOG (HIGHLIGHTS) <<", delay: 10, style: "color: var(--terminal-purple-term); text-decoration: underline" },
                { text: "\n", delay: 100 },
                { text: "> [S32] REACHED MYTHICAL GLORY 100+ STARS\n", delay: 20 },
                { text: "> [2024] TOURNAMENT CHAMPION - LOCAL E-SPORTS\n", delay: 20 },
                { text: "> [S31] GLOBAL RANKING URANUS - TOP 10\n", delay: 20 },
                { text: "> [2023] SQUAD LEADER - 'CELESTIALS'\n", delay: 20 },
                { text: "> [2021] MLBB KOL INDONESIA – COMPETITIVE PLAYER\n", delay: 20 },
                { text: "\n", delay: 100 },
                { text: ">> STATUS <<\n", delay: 10, style: "color: var(--terminal-purple-term); text-decoration: underline" },
                { text: "STATUS: AKTIF MENCARI LAWAN. SIAPAPUN YANG BERANI, MARI BY ONE. BUKTIKAN SKILL-MU DI LAND OF DAWN. RAJA BY ONE TIDAK AKAN MUNDUR. GASKEUN!", delay: 25, style: "color: var(--terminal-green); font-weight: bold; text-transform: uppercase;" },
                { text: "\n\n", delay: 100 },
                { text: "> Type 'help' for available commands", delay: 30, style: "color: var(--terminal-green)" },
                { text: "\n", delay: 50 },
            ];
            
            let currentMessageIndex = 0;
            let currentCharIndex = 0;
            
            function typeNextCharacter() {
                if (currentMessageIndex >= messages.length) {
                    commandLine.classList.remove('hidden');
                    commandInput.focus();
                    return;
                }
                
                const currentMessage = messages[currentMessageIndex];

                if (currentMessage.action) {
                    if (currentMessage.action === 'addPhoto') {
                        displayProfilePhoto();
                    }
                    currentMessageIndex++;
                    setTimeout(typeNextCharacter, currentMessage.delay);
                    return;
                }
                
                const textToType = currentMessage.text;
                
                if (currentCharIndex < textToType.length) {
                    const char = textToType.charAt(currentCharIndex);
                    const span = document.createElement('span');
                    span.textContent = char;
                    
                    if (currentMessage.style) {
                        span.style.cssText = currentMessage.style;
                    }
                    
                    terminalText.appendChild(span);
                    terminalBody.scrollTop = terminalBody.scrollHeight;
                    currentCharIndex++;
                    
                    setTimeout(typeNextCharacter, currentMessage.delay);
                } else {
                    currentMessageIndex++;
                    currentCharIndex = 0;
                    setTimeout(typeNextCharacter, 100);
                }
            }
            
            function typewriter(element, htmlString, onComplete) {
                let i = 0;
                const speed = 10;
                element.innerHTML = '';

                function type() {
                    if (i < htmlString.length) {
                        if (htmlString.charAt(i) === '<') {
                            const closingBracketIndex = htmlString.indexOf('>', i);
                            if (closingBracketIndex !== -1) {
                                const tag = htmlString.substring(i, closingBracketIndex + 1);
                                element.innerHTML += tag;
                                i = closingBracketIndex; 
                            }
                        } else {
                            element.innerHTML += htmlString.charAt(i);
                        }
                        
                        i++;
                        terminalBody.scrollTop = terminalBody.scrollHeight;
                        setTimeout(type, speed);
                    } else {
                        if (onComplete) {
                            onComplete();
                        }
                    }
                }
                type();
            }

            // --- [MODIFIED] Perintah terminal diganti ke tema MLBB ---
            function processCommand(command) {
                terminalText.appendChild(document.createElement('br'));
                
                const prompt = document.createElement('span');
                prompt.textContent = '> ';
                prompt.style.color = 'var(--terminal-green)';
                terminalText.appendChild(prompt);
                
                const cmdText = document.createElement('span');
                cmdText.textContent = command;
                cmdText.style.color = 'var(--text-color)';
                terminalText.appendChild(cmdText);
                
                terminalText.appendChild(document.createElement('br'));
                
                const response = document.createElement('div');
                response.style.marginTop = '10px';
                
                command = command.toLowerCase().trim();
                
                let isAnimated = false;
                
                const trackNumber = parseInt(command, 10);

                if (command === 'help') {
                    response.innerHTML = `Available commands:<br>
                        - <span class="highlight">profile</span>: Show complete profile of UranusFazry<br>
                        - <span class="highlight">lore</span>: Show player lore<br>
                        - <span class="highlight">mastery</span>: List hero mastery<br>
                        - <span class="highlight">log</span>: Show battle log highlights<br>
                        - <span class="highlight">squad</span>: Show squad & contact information<br>
                        - <span class="highlight">musik</span>: Menampilkan daftar musik.<br>
                        - <span class="highlight">&lt;nomor&gt;</span>: Memutar musik dari daftar (misal: '1').<br>
                        - <span class="highlight">stop</span>: Menghentikan musik.<br>
                        - <span class="highlight">clear</span>: Clear the terminal<br>
                        - <span class="highlight">exit</span>: Close terminal (just kidding)`;
                } else if (command === 'lore') {
                     response.innerHTML = `
                        <p style="color: var(--terminal-green); font-weight: bold; text-transform: uppercase;">
                        "AKU URANUS FAZRY, MAHKOTA RAJA BY ONE MLBB ADA DI KEPALA AKU. DI GAME GUE HABISIN KAMU, DI DUNIA NYATA GUE KUASAIN KAMU."
                        </p>
                    `;
                } else if (command === 'mastery') {
                    response.innerHTML = `>> HERO MASTERY <<<br><br>
                        <span style="color: var(--terminal-cyan)">> ASSASSIN:  █████████▉ 95%</span><br>
                        <span style="color: var(--terminal-cyan)">> MARKSMAN:  ██████████ 97%</span><br>
                        <span style="color: var(--terminal-cyan)">> MAGE:      ████████▉  88%</span><br>
                        <span style="color: var(--terminal-cyan)">> TANK:      ████████▊  86%</span><br>
                        <span style="color: var(--terminal-cyan)">> FIGHTER:   ███████▍   75%</span><br>
                        <span style="color: var(--terminal-cyan)">> SUPPORT:   ██████▎    70%</span><br>`;
                } else if (command === 'log') {
                    response.innerHTML = `>> BATTLE LOG (HIGHLIGHTS) <<<br><br>
                        > [S32] REACHED MYTHICAL GLORY 100+ STARS<br>
                        > [2024] TOURNAMENT CHAMPION - LOCAL E-SPORTS<br>
                        > [S31] GLOBAL RANKING URANUS - TOP 10<br>
                        > [2023] SQUAD LEADER - 'CELESTIALS'<br>`;
                } else if (command === 'squad' || command === 'contact') {
                    response.innerHTML = `>> SQUAD & CONTACT CHANNELS <<<br><br>
                        - Squad: <span class="highlight">CELESTIALS (Open Recruitment)</span><br>
                        - Email: <a href="mailto:irawanfazry697@gmail.com" class="highlight">irawanfazry697@gmail.com</a><br>
                        - WhatsApp: <a href="https://wa.me/6287872521809" target="_blank" class="highlight">wa.me/6287872521809</a>`;
                } else if (command === 'clear') {
                    terminalText.innerHTML = '';
                    commandInput.value = '';
                    return;
                } else if (command === 'musik') {
                    let musicListHtml = '>> DAFTAR MUSIK <<<br><br>';
                    musicList.forEach((song, index) => {
                        musicListHtml += `<span class="highlight">${index + 1}.</span> ${song.name}<br>`;
                    });
                    musicListHtml += "<br>Ketik nomor untuk memutar musik.";
                    response.innerHTML = musicListHtml;
                } else if (!isNaN(trackNumber) && trackNumber >= 1 && trackNumber <= musicList.length) {
                    const song = musicList[trackNumber - 1];
                    audioPlayer.src = song.url;
                    audioPlayer.play();
                    response.innerHTML = `Memutar: <span class="highlight">${song.name}</span>`;
                } else if (command === 'stop') {
                    audioPlayer.pause();
                    audioPlayer.src = '';
                    response.innerHTML = 'Musik dihentikan.';
                } else if (command === 'profile' || command === 'uranusfazry') {
                    isAnimated = true;
                    const profileHtml = `
                        <div style="color: var(--terminal-purple-term); text-decoration: underline;">// URANUSFAZRY - PLAYER PROFILE //</div><br>
                        <div><span class="highlight">> LORE</span></div>
                        <p style="margin-left: 15px;">
                            Uranus Fazry adalah seorang 'Raja By One' legendaris di Land of Dawn. Dikenal dengan penguasaan hero yang luas dan strategi tak terduga. Di luar game, ia adalah kreator digital, KOL, dan pebisnis yang mengaplikasikan mentalitas kompetitifnya di dunia nyata.
                        </p><br>
                        <div><span class="highlight">> ROLE UTAMA</span></div>
                        <div style="margin-left: 15px;">
                            - Marksman (Core)<br>
                            - Assassin (Jungler)<br>
                            - Tank (Roamer - Spesialis Uranus)
                        </div><br>
                        <div><span class="highlight">> PENCAPAIAN</span></div>
                        <div style="margin-left: 15px;">
                            - Mythical Glory 100+ Stars (Multi-Season)<br>
                            - Top 10 Global Uranus<br>
                            - Juara Turnamen Lokal
                        </div><br>
                        <div><span class="highlight">> KONTAK SQUAD</span></div>
                        <div style="margin-left: 15px;">
                            - Email: <a href="mailto:irawanfazry697@gmail.com" class="highlight">irawanfazry697@gmail.com</a><br>
                            - WhatsApp: <a href="https://wa.me/6287872521809" target="_blank" class="highlight">wa.me/6287872521809</a>
                        </div>
                    `;
                    
                    terminalText.appendChild(response);
                    commandInput.disabled = true;
                    
                    typewriter(response, profileHtml, () => {
                        commandInput.disabled = false;
                        commandInput.focus();
                        terminalText.appendChild(document.createElement('br'));
                        terminalBody.scrollTop = terminalBody.scrollHeight;
                    });

                } else if (command === 'exit') {
                    response.innerHTML = `<span style="color: var(--terminal-red)">Access Denied: Tidak bisa keluar dari Land of Dawn.</span>`;
                } else {
                    response.innerHTML = `<span style="color: var(--terminal-red)">Command not found: ${command}</span><br>
                    Type <span class="highlight">'help'</span> for available commands.`;
                }
                
                if (!isAnimated) {
                    terminalText.appendChild(response);
                    terminalText.appendChild(document.createElement('br'));
                    terminalBody.scrollTop = terminalBody.scrollHeight;
                }
            }
            
            commandInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    const command = this.value;
                    this.value = '';
                    
                    if (command.trim() !== '') {
                        processCommand(command);
                    }
                }
            });

            // --- INITIALIZE ALL SCRIPTS ---
            initPortalApp();
            init3DBackground();
            typeNextCharacter();
        });
    </script>

    <!-- MERGED: SCRIPT WATERMARK -->
    <script>
      (function() {
        function initializeWatermark() {
            const watermarkHTML = `
              <div id="futuristic-watermark" title="Design by ©URANUSFAZRY">
                <canvas id="particle-canvas"></canvas>
                <div class="f-content-wrapper">
                  <div id="f-main-content" class="f-content">
                    <div class="f-logo-container">
                      <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M20 20 L80 20 L80 80 L20 80 Z" stroke-opacity="0.5"/>
                          <path d="M50 5 L95 50 L50 95 L5 50 Z"/>
                      </svg>
                    </div>
                    <span id="f-watermark-text">©URANUSFAZRY</span>
                  </div>
                  <div id="f-follow-content" class="f-content hidden">
                      <span id="f-follow-message"></span>
                  </div>
                </div>
              </div>
            `;
            document.body.insertAdjacentHTML('beforeend', watermarkHTML);

            const watermarkEl = document.getElementById('futuristic-watermark');
            const textEl = document.getElementById('f-watermark-text');
            const logoEl = watermarkEl.querySelector('.f-logo-container');
            const mainContentEl = document.getElementById('f-main-content');
            const followContentEl = document.getElementById('f-follow-content');
            const followMessageEl = document.getElementById('f-follow-message');
            
            let isAnimating = false;
            let autoPlayInterval = null;
            let currentSequence = 0;
            const sequenceActions = ['scramble', 'logo', 'youtube', 'tiktok', 'reset'];

            const canvas = document.getElementById('particle-canvas');
            const ctx = canvas.getContext('2d');
            let particles = [];
            const resizeCanvas = () => { if (watermarkEl) { canvas.width = watermarkEl.offsetWidth; canvas.height = watermarkEl.offsetHeight; } };
            class Particle {
                constructor() { this.reset(); this.baseSpeedX = (Math.random() - 0.5) * 0.5; this.baseSpeedY = (Math.random() - 0.5) * 0.5; this.speedX = this.baseSpeedX; this.speedY = this.baseSpeedY; }
                update() {
                    this.x += this.speedX; this.y += this.speedY; this.opacity -= this.fadeSpeed;
                    if (this.opacity <= 0 || this.x < 0 || this.x > canvas.width || this.y < 0 || this.y > canvas.height) { this.reset(); }
                }
                draw() {
                    const style = getComputedStyle(watermarkEl);
                    const hue = style.getPropertyValue('--particle-base-hue').trim();
                    const lightness = parseFloat(style.getPropertyValue('--particle-base-lightness').trim());
                    ctx.globalAlpha = this.opacity;
                    ctx.fillStyle = `hsl(${hue}, 100%, ${lightness + this.opacity * 40}%)`;
                    ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
                }
                reset() { this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height; this.opacity = Math.random() * 0.5 + 0.2; this.size = Math.random() * 1.5 + 0.5; this.fadeSpeed = Math.random() * 0.015 + 0.005; }
            }
            const animateParticles = () => { ctx.clearRect(0, 0, canvas.width, canvas.height); particles.forEach(p => { p.update(); p.draw(); }); ctx.globalAlpha = 1.0; requestAnimationFrame(animateParticles); };
            
            const textScramble = (el) => {
                const originalText = "©URANUSFAZRY";
                const chars = '!<>*#{}[]'; let frame = 0; isAnimating = true;
                const interval = setInterval(() => {
                    el.innerText = originalText.split('').map((char, i) => { const p = (frame - i * 2) / 15; if (p < 0) return ' '; if (p > 1) return char; return chars[Math.floor(Math.random() * chars.length)]; }).join('');
                    if (frame >= originalText.length * 2 + 15) { clearInterval(interval); el.innerText = originalText; isAnimating = false; } frame++;
                }, 30);
            };

            const typewriter = (el, text) => {
                let i = 0; el.innerHTML = ""; isAnimating = true;
                const interval = setInterval(() => {
                    if (i < text.length) { el.innerHTML += text.charAt(i); i++; } 
                    else { clearInterval(interval); isAnimating = false; }
                }, 50);
            };

            const runAutoSequence = () => {
                if (isAnimating) return;
                const action = sequenceActions[currentSequence];
                switch (action) {
                    case 'scramble': textScramble(textEl); break;
                    case 'logo':
                        isAnimating = true;
                        logoEl.classList.add('reacting');
                        logoEl.addEventListener('animationend', () => { logoEl.classList.remove('reacting'); isAnimating = false; }, { once: true });
                        break;
                    case 'youtube':
                        isAnimating = true;
                        mainContentEl.classList.add('hidden');
                        setTimeout(() => {
                            followContentEl.classList.remove('hidden');
                            typewriter(followMessageEl, "Follow uranusfazry YouTube");
                        }, 400);
                        break;
                    case 'tiktok': 
                        typewriter(followMessageEl, "Follow uranusfazry TikTok"); 
                        break;
                    case 'reset':
                        isAnimating = true;
                        followContentEl.classList.add('hidden');
                        setTimeout(() => {
                            mainContentEl.classList.remove('hidden');
                            isAnimating = false;
                        }, 400);
                        break;
                }
                currentSequence = (currentSequence + 1) % sequenceActions.length;
            };

            const startAutoPlay = () => {
                if (autoPlayInterval) clearInterval(autoPlayInterval);
                runAutoSequence();
                autoPlayInterval = setInterval(runAutoSequence, 3500);
            };

            watermarkEl.addEventListener('click', () => { watermarkEl.classList.toggle('light-mode'); });
            
            const init = () => {
                resizeCanvas();
                for (let i = 0; i < 40; i++) particles.push(new Particle());
                animateParticles();
                window.addEventListener('resize', resizeCanvas);
                startAutoPlay();
            };
            init();
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeWatermark);
        } else {
            initializeWatermark();
        }
      })();
    </script>
</body>
</html>
